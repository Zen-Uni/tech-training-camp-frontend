2021.11.20 æ›´æ–°

æ‰‹å†™äº†ä¸€ä¸ªDemoï¼Œè§£å†³äº†ç¼©è¿›åµŒå¥—çš„é—®é¢˜ï¼Œniceï½

Demoå·²æ›´æ–°åˆ°Demoæ–‡ä»¶å¤¹ï¼Œè¿˜æœ‰äº›ä»£ç éœ€è¦æŠ½ç¦»ã€å¤ç”¨ä¸€ä¸‹

---

çº¿ä¸Šåœ°å€ï¼šå·²åºŸå¼ƒ(åŸåŸŸåå·²é‡Šæ”¾ï¼Œ2021.11.20æ‰å‘ç°ï¼Œä¸å¥½æ„æ€)

æ¼”ç¤ºã€æ€»ç»“è§†é¢‘ï¼šhttps://upyun.hokori.online/2021-03-17/bd_markdown.mp4

### é¡¹ç›®åŸºæœ¬éœ€æ±‚ï¼ˆåšçš„æ—¶å€™ä¸€å®šè¦è®°å¾—è¿™ä¸ªï¼Œä¸è¦åšåäº†ğŸ”’ï¼‰

- å®ç°ä¸€ä¸ªå·¦å³ç»“æ„çš„Markdownç¼–è¾‘å™¨ï¼ˆå·¦è¾¹ç¼–è¾‘ï¼Œå³è¾¹å®æ—¶é¢„è§ˆï¼‰
- å®Œå…¨æ”¯æŒ [Github çš„æ ‡å‡†Markdownè¯­æ³•](https://github.github.com/gfm/)
- é¡¶éƒ¨è¦æœ‰å¿«æ·å·¥å…·æ 



### ä¸ªäººç†è§£

ç”±äºè¿™æ˜¯ä¸€æ¬¡è®­ç»ƒï¼Œæ‰€ä»¥è¿˜æ˜¯ä¸é‡‡ç”¨åº“å»å®ç° `Markdown` è§£æäº†ï¼Œè¿™é‡Œç›´æ¥é‡‡ç”¨çš„è‡ªå·±å†™çš„ï¼Œå­˜ç•™ä¸€äº› bugã€‚

åŒæ—¶ï¼Œæˆ‘è®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªäº§å“ï¼Œæˆ‘éœ€è¦è´Ÿè´£å¥½å®ƒå®Œæ•´çš„ä¸šåŠ¡æµç¨‹ï¼Œæ‰€ä»¥æ·»åŠ äº†ç™»å½•æ³¨å†Œç­‰åŠŸèƒ½ï¼Œä»¥ä¾¿å¢å¼ºç”¨æˆ·ä½“éªŒã€‚



### ä¸ªäººå®ç°ç›®æ ‡

> å› ä¸ºæ˜¯ä¸€ä¸ªè®­ç»ƒè¥é¡¹ç›®ï¼Œå¹¶ä¸æ˜¯åœ¨æ¬ç –è€Œæ˜¯è¦å‘æŒ¥è‡ªç”±æ„å¿—ï¼Œæ‰€ä»¥æƒ³è®©è‡ªå·±åœ¨å®Œæˆéœ€æ±‚çš„åŒæ—¶è¶Šå¼€å¿ƒè¶Šè‡ªç”±è¶Šå¿«ä¹è¶Šå¥½ï¼Œå› æ­¤åˆ¶å®šäº†åƒæ‰“æ¸¸æˆé€šå…³ä¸€æ ·çš„å°ç›®æ ‡ï¼Œå˜¿å˜¿ğŸ˜€
>
> ä¸å¥½é«˜éª›è¿œï¼Œå…ˆä¸“æ³¨å®Œæˆå¿…é¡»å¾—åšçš„ï¼Œå‰©ä¸‹çš„äº¤ç»™å¿«ä¹ğŸ˜„



#### ç¬¬ä¸€é˜¶æ®µ(å®ŒæˆåŸºç¡€éœ€æ±‚)

- [x] å®ç°ç¼–è¾‘å™¨é¡µé¢çš„å®Œæ•´ã€æµç•…çš„å¸ƒå±€

- [x] å®Œæˆ `markdown`è¯­æ³•è½¬æ¢ `html`çš„åŠŸèƒ½

- [x] å®ç°å¿«æ·å·¥å…·æ 

#### ç¬¬äºŒé˜¶æ®µ(æ¥åç«¯ï¼Œä¿è¯äº§å“çš„å®Œæ•´æ€§)

- [ ] å®ç°è‡ªåŠ¨éƒ¨ç½²
- [x] æ‰©å±•ç™»å½•æ³¨å†Œé¡µã€æ‰€æœ‰æ–‡ç« é¡µè·¯ç”±ã€æ–‡ç« è¯¦æƒ…å±•ç¤ºï¼ˆé‡‡ç”¨åŠ¨æ€è·¯ç”±ï¼‰
- [x] å®ç°é‚®ç®±åˆ†å‘æ³¨å†Œè´¦æˆ·çš„éªŒè¯ç 
- [x] é‡‡ç”¨ `token` å®ç°çŠ¶æ€å’Œé‰´æƒ
- [x] å®ç°æ–‡ç« å­˜å‚¨åŠŸèƒ½ï¼ˆé‡‡ç”¨`Koa2`ã€`mongoDB`ã€`mongoose`ï¼‰

- [x] æ›´æ”¹å¤´åƒ

- [x] å®Œæˆæ‰€æœ‰æ–‡ç« é¡µ
- [x] æ–‡ç« è¯¦æƒ…å±•ç¤º

#### ç¬¬ä¸‰é˜¶æ®µï¼ˆæ–‡ç« å…±äº«åŠååŒç¼–è¾‘ï¼Œè¯´å®è¯è¿™ä¸ªçº¯ç²¹æ˜¯å¾—å°½åŠ›çš„æŒ‘æˆ˜ï¼Œæœ‰ç‚¹èµ¶ï¼Œå°½å¯èƒ½é€šå…³åˆ°è¿™ä¸ªé˜¶æ®µå§ï¼Œå¿«ä¹å°±å®Œäº‹äº†ğŸ˜ï¼‰

- [x] å®Œæˆæ–‡ç« çš„é‡æ–°ç¼–è¾‘
- [x] å®Œæˆæ–‡ç« çš„å…±äº«åŠŸèƒ½
- [x] å®ŒæˆååŒç¼–è¾‘ï¼ˆå…¶å®ä¸ç®—å®Œæˆï¼Œåªæ˜¯å®ç°å¤šç”¨æˆ·å¯¹åŒä¸€ä¸ªæ–‡ç« æ“ä½œï¼‰

- [x] æ·»åŠ  websocket



### é¡¹ç›®å®ç°åŠè®¾è®¡

#### è§„èŒƒ

- Gitæäº¤ï¼šåœ¨é¡¹ç›®åˆæœŸé‡‡ç”¨åˆ†æ”¯å¼€å‘ï¼Œ`client-develop`æ˜¯å‰ç«¯åˆ†æ”¯ï¼Œ`server-develop`æ˜¯åç«¯åˆ†æ”¯ï¼Œ`main`åˆ†æ”¯æ˜¯å®Œæ•´åŠŸèƒ½çš„æ›´æ–°ã€‚åæœŸè€ƒè™‘åˆ°æ–¹ä¾¿æ€§å’Œæ—¶é—´ç¼˜æ•…ï¼Œç»Ÿä¸€åœ¨`main`æ›´æ–°æ¯ä¸€ä¸ªå®Œå–„ç‰ˆæœ¬
- CSSå‘½åï¼šé‡‡ç”¨ `BEM` å‘½åè§„èŒƒ
- ç‰ˆæœ¬æäº¤ä¿¡æ¯è§„èŒƒ
  - `feat`: åŠŸèƒ½æ›´æ–°
  - `docs`: æ–‡æ¡£æ›´æ–°
  - `fix`: ä¿®è¡¥ bug
- å“åº”æ•°æ®æ ¼å¼
  - code: 0 | 1,  0: æˆåŠŸï¼›1: å¤±è´¥
  - msg: å“åº”ä¿¡æ¯
  - data: å“åº”ç›¸å…³ä¸šåŠ¡æ•°æ®
- è®¾ç½®é”™è¯¯ç 

#### æŠ€æœ¯æ ˆ

##### å‰ç«¯ï¼š

- React
- react-router-dom / react-router
- react-redux
- redux
- Ant-Design
- react-router-config
- axios

##### åç«¯ï¼š

- Koa2åŠç›¸å…³ç”Ÿæ€
- MongoDB
- mongoose
- nodemailer
- websocket



#### é¡¹ç›®ç»“æ„

##### å‰ç«¯

```
- src
	- modules (é¡¹ç›®ç»„ä»¶)
		- Article ï¼ˆé¦–é¡µç»„ä»¶ï¼‰
		- Cooperation ï¼ˆåä½œç¼–è¾‘é¡µé¢ç»„ä»¶ï¼‰
		- Edit ï¼ˆç¼–è¾‘é¡µé¢ç»„ä»¶ï¼‰
		- Home ï¼ˆæ–‡ç« è¯¦æƒ…é¡µé¢ç»„ä»¶ï¼‰
		- LoginAndRegister ï¼ˆç™»å½•æ³¨å†Œé¡µé¢ç»„ä»¶ï¼‰
		- NotFound ï¼ˆ404 not found é¡µé¢ç»„ä»¶ï¼‰
	- staticï¼ˆé™æ€èµ„æºï¼‰
	- store ï¼ˆreduxç®¡ç†æ•°æ®é€»è¾‘ï¼‰
	- util ï¼ˆä¸€äº›å°è£…æ¨¡å—ï¼‰
		- fetch.js ï¼ˆå¯¹axiosè¿›è¡ŒäºŒæ¬¡å°è£…ï¼‰
		- markdown-particle.jsï¼ˆæ‰‹å†™çš„ markdown è§£æå™¨ï¼‰
		- message.js ï¼ˆæ‰‹å†™çš„å‰ç«¯æ•°æ®æ¨¡å‹ï¼‰
		- token.js ï¼ˆå‰ç«¯ token çŠ¶æ€å¤„ç†ï¼‰
		- tool-bar.js (å¯¹å¿«æ·å·¥å…·æ è¿›è¡Œå°è£…)
	- App.js ï¼ˆé¡¹ç›®ä¸»ç»„ä»¶ï¼Œç”¨äºç››æ”¾è·¯ç”±æ¸²æŸ“ï¼‰
	- index.js ï¼ˆå…¥å£æ–‡ä»¶ï¼‰
	- routes.js ï¼ˆè·¯ç”±é›†ä¸­é…ç½®ï¼Œé‡‡ç”¨ react-router-config)
	- service.js ï¼ˆé›†ä¸­å‰ç«¯è¯·æ±‚æ¥å£ï¼‰
	- package.json ï¼ˆé¡¹ç›®é…ç½®ï¼‰
```

##### åç«¯

```
- server
	- bin
	- config (é…ç½®ä¿¡æ¯)
		- emailConfig.js ï¼ˆé‚®ç®±æœåŠ¡ä¿¡æ¯é…ç½®ï¼‰
		- resultModel.js ï¼ˆå“åº”æ¥å£æ•°æ®æ¨¡å‹ï¼‰
	- controller (ä¸æ•°æ®åº“äº¤äº’çš„é€»è¾‘å±‚)
	- db ï¼ˆæ•°æ®åº“æ¨¡å‹ã€è¿æ¥ç­‰æ“ä½œï¼‰
	- middleware/jwt ï¼ˆå…³äº jsonwebtoken çš„ä¸€äº›é€»è¾‘ï¼Œåˆ›å»ºã€åˆ†é… tokenï¼‰
	- routes ï¼ˆåç«¯ APIï¼‰
	- app.js
```



#### é¡µé¢åŠé‰´æƒ

é‡‡ç”¨äº† `token` å¯¹æ•°æ®è¿›è¡ŒçŠ¶æ€ç®¡ç†ï¼Œå°† `token` è®¾ç½®åœ¨äº†è¯·æ±‚å¤´ä¸­ï¼Œä¸”ç”¨ `window.localStorage` å¯¹ `token` è¿›è¡Œç¼“å­˜ã€‚

```js
//  client/src/util/token.js

import axios from 'axios'


const site = "BYTEDANCE_LCH"

export const storeToken = token => {
    window.localStorage.setItem(site, token)
}

export const getToken = () => {
    return window.localStorage.getItem(site)
}

export const configReq = () => {
    const token = getToken()
    console.log(token)
    if (token) {
        axios.interceptors.request.use(config => {
            config.headers.Authorization = `Bearer ${token}`
            return config
        })
        
    } 
}

export const removeToken = () => {
    return window.localStorage.removeItem(site)
}
```



- `/` : é¦–é¡µï¼Œæ— æƒé™é™åˆ¶
- `/sign`: ç™»å½•æ³¨å†Œé¡µé¢ï¼Œå¦‚æœåˆ¤å®šå·²ç»ç™»å½•ï¼ˆåŠæºå¸¦æœªè¿‡æœŸ  `token ` ï¼‰åˆ™ç›´æ¥è·³è½¬è‡³ `/`
- `/edit`: ç¼–è¾‘é¡µé¢ï¼Œå¦‚æœåˆ¤å®šå°šæœªç™»å½•ï¼ˆåŠæœªæºå¸¦ `token `æˆ– `token` å·²è¿‡æœŸï¼‰åˆ™ç›´æ¥è·³è½¬è‡³ `/`

- `/article/:id`: æ–‡ç« è¯¦æƒ…é¡µé¢ï¼Œ æ— æƒé™é™åˆ¶ï¼Œé‡‡ç”¨åŠ¨æ€è·¯ç”±ï¼Œ`id`ä»£è¡¨æ¯ç¯‡æ–‡ç« åœ¨æ•°æ®åº“ä¸­å­˜å‚¨çš„`id`

- `/cooperation/:id`: ååŒç¼–è¾‘é¡µé¢ï¼Œåªæœ‰ä½œè€…åˆ†äº«äº†æ­¤ç¯‡æ–‡ç« ï¼Œæ‰å¯ä»¥è¿›è¡Œå…±åŒç¼–è¾‘ï¼ŒåŒæ ·é‡‡ç”¨åŠ¨æ€è·¯ç”±ã€‚è‹¥ä½œè€…åˆ†äº«äº†æ­¤é¡µé¢ï¼Œç™»å½•çš„ç”¨æˆ·å¯è¿›è¡Œç¼–è¾‘ï¼Œæœªç™»å½•ç”¨æˆ·åˆ™æ— æ³•è®¿é—®ã€‚
- `/*`: æœªåŒ¹é…åˆ°çš„é¡µé¢ï¼Œè¿”å› `404 not found`



#### æ¥å£è®¾è®¡

æ­¤æ¬¡è¯·æ±‚åº“é‡‡ç”¨ `axios`ï¼Œ åŒæ—¶å¯¹è¯·æ±‚è¿›è¡Œäº†äºŒæ¬¡å°è£…ï¼Œèƒ½å¤Ÿæ–¹ä¾¿åœ°è¿›è¡Œå¼‚æ­¥ç®¡ç†ï¼š

```js
//  client/src/util/fetch.js
import axios from 'axios'

export default function fetch(rootPath) {
    return function(method, path, data) {
        return new Promise((resolve, reject) => {
            if (method === 'get') {
                axios.get(rootPath + path)
                .then(res => {
                    resolve(res.data)
                })
            }

            if (method === 'post') {
                axios.post(rootPath + path, data)
                .then(res => {
                    resolve(res.data)
                })
            }
        })
    }
}
```



```js
//  client/src/service.js
import fetch from './util/fetch'

const rootPath = 'http://127.0.0.1:4000/api'
const axios = fetch(rootPath)

export async function login(data) {
    const res = await axios('post', '/user/login', data)
    return res
}

export async function captcha(data) {
    const res = await axios('post', '/user/captcha', data)
    return res
}

export async function register(data) {
    const res = await axios('post', '/user/register', data) 
    return res
}


export async function checkToken() {
    const res = await axios('get', '/user/token')
    return res
}

export async function postArticle(payload) {
    const res = await axios('post', '/user/post-article', payload)
    return res
}

export async function getArticle() {
    const res = await axios('get', '/user/article-list')
    return res
}

export async function getDetails(id) {
    const res = await axios('post', '/user/article-detail', {id})
    return res
}

export async function upDateArticle(payload) {
    const res = await axios('post', '/user/article-update', payload)
    return res
}
```



#### å“åº”æ•°æ®æ¨¡å‹

åœ¨æœåŠ¡ç«¯ï¼Œè®¾è®¡äº†ä¸¤ç§å“åº”æ¨¡å‹ï¼š`SuccessModel` å’Œ `ErrorModule`ï¼Œä½¿å¾—å“åº”æ•°æ®ç»Ÿä¸€

```js
//   server/config/resultModel.js
 class BaseModel {
    constructor(data, msg) {
        if (typeof data === 'string') {
            this.msg = data
            data = null
            msg = null
        }

        if (data) {
            this.data = data
        }

        if (msg) {
            this.msg = msg
        }
    }
}

// successful result model
class SuccessModel extends BaseModel {
    constructor(data, msg) {
        super(data, msg)
        this.code = 0
    }
}

// error result model
class ErrorModel extends BaseModel {
    constructor(data, msg) {
        super(data, msg)
        this.code = 1
    }
}

module.exports = {
    SuccessModel,
    ErrorModel
}
```





#### å‰ç«¯æ•°æ®ç®¡ç†

é‡‡ç”¨ `redux` è¿›è¡Œæ•°æ®ç®¡ç†ï¼Œä½¿ç”¨ `react-redux` ç®€åŒ–å¯¹`redux`çš„æ“ä½œã€‚

å­˜å‚¨çš„æ•°æ®ç±»å‹ï¼š

- å…¨å±€æ•°æ®ï¼šä¸ºäº†å‡å°‘ä¸è¦çš„è¯·æ±‚
- Markdown è¯­æ³•è§£æï¼šæ–¹ä¾¿æ¥å…¥ä¸ªäººæ‰‹å†™çš„è§£ææ¨¡å—ï¼Œå¹¶ä¸”èƒ½å¤Ÿå°†æ“ä½œé›†ä¸­èµ·æ¥ï¼Œæ–¹ä¾¿ä¸åŒç»„ä»¶ä½¿ç”¨



### èµ„æºåˆ†äº«åŠé—®é¢˜æ”¶é›†

[ç§»æ­¥ issues åŒº](https://github.com/Zen-Uni/tech-training-camp-frontend/issues)

è¿™ä¹ˆåšçš„ç›®çš„æ˜¯ï¼š

1ã€ä¼™ä¼´ä»¬åœ¨ç¾¤é‡Œè®¨è®ºçš„æ—¶å€™ï¼Œå…±äº«çš„èµ„æºæ²¡æœ‰å¾ˆå¥½çš„æ”¶é›†èµ·æ¥ï¼Œå†è¿›è¡ŒæŸ¥æ‰¾ä¼šéå¸¸çš„ä¸æ–¹ä¾¿ï¼Œæ‰€ä»¥æˆ‘å°†å¤§å®¶åˆ†äº«çš„èµ„æºå’Œæˆ‘ä¸ªäººåˆ†äº«çš„éƒ½æ”¾åˆ° `issues`äº†ï¼ˆä¼™ä¼´ä»¬åˆ†äº«çš„å·²å¾å¾—è®¸å¯ï¼Œæ”¾ç½®ä»“åº“ï¼‰

2ã€å°†å¤§å®¶çš„é—®é¢˜é›†ä¸­èµ·æ¥ï¼Œé¿å…å†æ¬¡è¸©å‘ï¼Œæ–¹ä¾¿å¤§å®¶æ¢³ç†æ€è·¯å’Œå®Œå–„é€»è¾‘



### å¿ƒè·¯å†ç¨‹

emmmmï¼Œå¿«ä¹å°±å®Œäº‹äº†ğŸ˜

å¾ˆæ„Ÿè°¢å¯¼å¸ˆä»¬åœ¨å·¥ä½œä¹‹ä½™æŠ½æ—¶é—´æ¥å½•è¯¾ğŸ’“

ä¹Ÿå¾ˆå¼€å¿ƒè®¤è¯†äº†ä¼™ä¼´ä»¬ï¼Œå¥½å‡ ä¸ªä¼™ä¼´è¿˜åŠ äº†å¾®ä¿¡ï¼Œè¿™æ³¢èµšäº†ğŸ’ª

ä½†æ˜¯ç¾ä¸­ä¸è¶³çš„å°±æ˜¯ï¼Œä¼™ä¼´ä»¬å¤ªå°‘ä¸€èµ·è®¨è®ºå®é™…çš„åŠŸèƒ½ç»†èŠ‚ï¼Œæˆ‘çœŸçš„å¾ˆæƒ³ä½“éªŒä¸€èµ·åä½œçš„æ„Ÿè§‰ï¼Œæœ‰äº›è®¸é—æ†¾ğŸ˜­

æœ€åï¼Œå¸Œæœ›å¯¼å¸ˆä»¬ã€HRå°å§å§ä»¬ã€ä¼™ä¼´ä»¬ï¼Œå¤©å¤©å¼€å¿ƒï¼å¿«ä¹å°±å®Œäº‹å•¦ï¼èŠœæ¹–â­
